<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Outbreak analytics with R: </title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/02-practical-tutors.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NA%" class="percentage">
    NA%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: NA%" aria-valuenow="NA" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/02-practical-tutors.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="delays-introduction.html">1. Introduction to outbreak analytics</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="delays-distribution.html">2. Introduction to delays</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1></h1>
        <p>Last updated on 2025-05-29 |

        <a href="https://github.com/epiverse-trace/tutorials/edit/main/instructors/02-practical-tutors.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="section level1">
<h1 id="week-2-access-delays-to-estimate-transmission-and-severity">Week 2: Access delays to estimate transmission and severity<a class="anchor" aria-label="anchor" href="#week-2-access-delays-to-estimate-transmission-and-severity"></a></h1>
<!-- visible for instructors only -->
<!-- practical-week.md is generated from practical-week.qmd. Please edit that file -->
<!-- commit .md and .qmd files together -->
<!-- does not work for instructors text messages -->
<!-- works for text on html and MD only -->
<p>This practical is based in the following tutorial episodes:</p>
<ul><li><a href="https://epiverse-trace.github.io/tutorials-middle/delays-access.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/delays-access.html</a></li>
<li><a href="https://epiverse-trace.github.io/tutorials-middle/quantify-transmissibility.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/quantify-transmissibility.html</a></li>
<li><a href="https://epiverse-trace.github.io/tutorials-middle/delays-functions.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/delays-functions.html</a></li>
<li><a href="https://epiverse-trace.github.io/tutorials-middle/severity-static.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/severity-static.html</a></li>
</ul><p>Welcome!</p>
<ul><li>A reminder of our <a href="https://github.com/epiverse-trace/.github/blob/main/CODE_OF_CONDUCT.md" class="external-link">Code
of Conduct</a>. If you experience or witness unacceptable behaviour, or
have any other concerns, please notify the course organisers or host of
the event. To report an issue involving one of the organisers, please
use the <a href="https://reportandsupport.lshtm.ac.uk/" class="external-link">LSHTM’s Report
and Support tool</a>.</li>
</ul></div>
<div class="section level1">
<h1 id="read-this-first">Read This First<a class="anchor" aria-label="anchor" href="#read-this-first"></a></h1>
<!-- visible for learners and instructors at practical -->
<p>Instructions:</p>
<ul><li>Each <code>Activity</code> has five sections: the Goal, Questions,
Inputs, Your Code, and Your Answers.</li>
<li>Solve each Activity in the corresponding <code>.R</code> file
mentioned in the <code>Your Code</code> section.</li>
<li>Paste your figure and table outputs and write your answer to the
questions in the section <code>Your Answers</code>.</li>
<li>Choose one group member to share your group’s results with the rest
of the participants.</li>
</ul><p>During the practical, instead of simply copying and pasting, we
encourage learners to increase their fluency writing R by using:</p>
<ul><li>The double-colon notation, e.g. <code>package::function()</code> to
specify which package a function comes from, avoid namespace conflicts,
and find functions using keywords.</li>
<li>Tab key <kbd>↹</kbd> to <a href="https://support.posit.co/hc/en-us/articles/205273297-Code-Completion-in-the-RStudio-IDE" class="external-link">autocomplete
package or function names</a> and <a href="https://docs.posit.co/ide/user/ide/guide/code/console.html" class="external-link">display
possible arguments</a>.</li>
<li>
<a href="https://docs.posit.co/ide/user/ide/guide/code/execution.html" class="external-link">Execute
one line of code</a> or multiple lines connected by the pipe operator
(<code>%&gt;%</code>) by placing the cursor in the code of interest and
pressing the <code>Ctrl</code>+<code>Enter</code>.</li>
<li>
<a href="https://positron.posit.co/keyboard-shortcuts.html#r-shortcuts" class="external-link">R
shortcuts</a> to insert the pipe operator (<code>%&gt;%</code>) using
<code>Ctrl/Cmd</code>+<code>Shift</code>+<code>M</code>, or insert the
assignment operator (<code>&lt;-</code>) using
<code>Alt/Option</code>+<code>-</code>.
<!-- - Get [help yourself with R](https://www.r-project.org/help.html) using the `help()` function or `?` operator to access the function reference manual. -->
</li>
</ul><p>If your local configuration was not possible to setup:</p>
<ul><li>Create one copy of the <a href="https://posit.cloud/spaces/609790/join?access_code=hPM1tIeKt5ax_Y-P0lMGVUGqzFPNH4wxkKSzXZYb" class="external-link">Posit
Cloud RStudio project</a>.</li>
</ul><div class="section level2">
<h2 id="paste-your-error-messages-here">Paste your !Error messages here<a class="anchor" aria-label="anchor" href="#paste-your-error-messages-here"></a></h2>
</div>
</div>
<div class="section level1">
<h1 id="practical">Practical<a class="anchor" aria-label="anchor" href="#practical"></a></h1>
<p>This practical has two activities.</p>
<div class="section level2">
<h2 id="activity-1-transmission">Activity 1: Transmission<a class="anchor" aria-label="anchor" href="#activity-1-transmission"></a></h2>
<p>Estimate <span class="math inline">\(R_{t}\)</span>, <em>new
infections</em>, <em>new reports</em>, <em>growth rate</em>, and
<em>doubling/halving time</em> using the following available inputs:</p>
<ul><li>Incidence of reported cases per day</li>
<li>Reporting delay</li>
</ul><p>As a group, Write your answers to these questions:</p>
<ul><li>What phase of the epidemic are you observing? (Exponential growth
phase, near peak, or decay end phase)</li>
<li>Is the expected change in daily reports consistent with the
estimated effective reproductive number, growth rate, and doubling
time?</li>
<li>Interpret: How would you communicate these results to a
decision-maker?</li>
<li>Compare: What differences do you identify from other group outputs?
(if available)</li>
</ul><div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a></h3>
<table class="table"><colgroup><col width="7%"><col width="15%"><col width="77%"></colgroup><thead><tr class="header"><th>Group</th>
<th>Incidence</th>
<th>Link</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td>COVID 30 days</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/covid_30days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/covid_30days.rds</a></td>
</tr><tr class="even"><td>2</td>
<td>Ebola 35 days</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/ebola_35days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/ebola_35days.rds</a></td>
</tr><tr class="odd"><td>3</td>
<td>Ebola 60 days</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/ebola_60days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/ebola_60days.rds</a></td>
</tr><tr class="even"><td>4</td>
<td>COVID 60 days</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/covid_60days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/covid_60days.rds</a></td>
</tr></tbody></table><table class="table"><colgroup><col width="2%"><col width="97%"></colgroup><thead><tr class="header"><th>Disease</th>
<th>Reporting delays</th>
</tr></thead><tbody><tr class="odd"><td>Ebola</td>
<td>The time difference between symptom onset and case report follows a
Lognormal distribution with uncertainty. The <strong>meanlog</strong>
follows a Normal distribution with mean = 1.4 days and sd = 0.5 days.
The <strong>sdlog</strong> follows a Normal distribution with mean =
0.25 days and sd = 0.2 days. Bound the distribution with a maximum = 5
days.</td>
</tr><tr class="even"><td>COVID</td>
<td>The time difference between symptom onset and case report follows a
Gamma distribution with uncertainty. The <strong>mean</strong> follows a
Normal distribution with mean = 2 days and sd = 0.5 days. The
<strong>standard deviation</strong> follows a Normal distribution with
mean = 1 day and sd = 0.5 days. Bound the distribution with a maximum =
5 days.</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="solution">Solution<a class="anchor" aria-label="anchor" href="#solution"></a></h3>
<!-- visible for instructors and learners after practical (solutions) -->
<div class="section level4">
<h4 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a></h4>
<div class="section level5">
<h5 id="ebola-sample">Ebola (sample)<a class="anchor" aria-label="anchor" href="#ebola-sample"></a></h5>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read reported cases -----------------------------------------------------</span></span>
<span><span class="va">dat_ebola</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/ebola_35days.rds"</span>  <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">date</span>, confirm <span class="op">=</span> <span class="va">cases</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a generation time from {epiparameter} to {EpiNow2} ---------------</span></span>
<span></span>
<span><span class="co"># access a serial interval</span></span>
<span><span class="va">ebola_serialint</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract parameters from {epiparameter} object</span></span>
<span><span class="va">ebola_serialint_params</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">ebola_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt {epiparameter} to {EpiNow2} distribution inferfase</span></span>
<span><span class="co"># preferred</span></span>
<span><span class="va">ebola_generationtime</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  shape <span class="op">=</span> <span class="va">ebola_serialint_params</span><span class="op">[</span><span class="st">"shape"</span><span class="op">]</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">ebola_serialint_params</span><span class="op">[</span><span class="st">"scale"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">ebola_generationtime</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">ebola_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">ebola_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Define the delays from infection to case report for {EpiNow2} -----------</span></span>
<span></span>
<span><span class="co"># define delay from symptom onset to case report</span></span>
<span><span class="co"># or reporting delay</span></span>
<span><span class="va">ebola_reportdelay</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  meanlog <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">1.4</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0.25</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define a delay from infection to symptom onset</span></span>
<span><span class="co"># or incubation period</span></span>
<span><span class="va">ebola_incubationtime</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"ebola"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: extract distribution parameters</span></span>
<span><span class="va">ebola_incubationtime_params</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span></span>
<span>  <span class="va">ebola_incubationtime</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: discretize and extract maximum value (p = 99%)</span></span>
<span><span class="co"># preferred</span></span>
<span><span class="va">ebola_incubationtime_max</span> <span class="op">&lt;-</span> <span class="va">ebola_incubationtime</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">ebola_incubationtime_max</span> <span class="op">&lt;-</span> <span class="va">ebola_incubationtime</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu">round</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: adapt to {EpiNow2} distribution interface</span></span>
<span><span class="va">ebola_incubationtime_epinow</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  shape <span class="op">=</span> <span class="va">ebola_incubationtime_params</span><span class="op">[</span><span class="st">"shape"</span><span class="op">]</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">ebola_incubationtime_params</span><span class="op">[</span><span class="st">"scale"</span><span class="op">]</span>,</span>
<span>  max <span class="op">=</span> <span class="va">ebola_incubationtime_max</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect required input</span></span>
<span><span class="va">ebola_generationtime</span></span>
<span><span class="va">ebola_reportdelay</span></span>
<span><span class="va">ebola_incubationtime_epinow</span></span>
<span></span>
<span></span>
<span><span class="co"># Set the number of parallel cores for {EpiNow2} --------------------------</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu">local_options</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Estimate transmission using EpiNow2::epinow() ---------------------------</span></span>
<span><span class="co"># with EpiNow2::*_opts() functions for generation time, delays, and stan.</span></span>
<span><span class="va">ebola_estimates</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">epinow</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat_ebola</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">ebola_generationtime</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">ebola_incubationtime_epinow</span> <span class="op">+</span> <span class="va">ebola_reportdelay</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">stan_opts</span><span class="op">(</span>samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Print plot and summary table outputs ------------------------------------</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">ebola_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="covid-sample">COVID (sample)<a class="anchor" aria-label="anchor" href="#covid-sample"></a></h5>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">EpiNow2</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read reported cases -----------------------------------------------------</span></span>
<span><span class="va">dat_covid</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/covid_30days.rds"</span>  <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">select</span><span class="op">(</span><span class="va">date</span>, <span class="va">confirm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a generation time from {epiparameter} to {EpiNow2} ---------------</span></span>
<span></span>
<span><span class="co"># access a serial interval</span></span>
<span><span class="va">covid_serialint</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"serial"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract parameters from {epiparameter} object</span></span>
<span><span class="va">covid_serialint_params</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span><span class="va">covid_serialint</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># adapt {epiparameter} to {EpiNow2} distribution inferfase</span></span>
<span><span class="co"># preferred</span></span>
<span><span class="va">covid_generationtime</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  meanlog <span class="op">=</span> <span class="va">covid_serialint_params</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">covid_serialint_params</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">covid_generationtime</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">covid_serialint</span><span class="op">$</span><span class="va">summary_stats</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Define the delays from infection to case report for {EpiNow2} -----------</span></span>
<span></span>
<span><span class="co"># define delay from symptom onset to case report</span></span>
<span><span class="co"># or reporting delay</span></span>
<span><span class="va">covid_reportdelay</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Gamma</span><span class="op">(</span></span>
<span>  mean <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sd <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">Normal</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  max <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define a delay from infection to symptom onset</span></span>
<span><span class="co"># or incubation period</span></span>
<span><span class="va">covid_incubationtime</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"incubation"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: extract distribution parameters</span></span>
<span><span class="va">covid_incubationtime_params</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">get_parameters</span><span class="op">(</span></span>
<span>  <span class="va">covid_incubationtime</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: discretize and extract maximum value (p = 99%)</span></span>
<span><span class="co"># preferred</span></span>
<span><span class="va">covid_incubationtime_max</span> <span class="op">&lt;-</span> <span class="va">covid_incubationtime</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">discretise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span>
<span><span class="co"># or</span></span>
<span><span class="va">ebola_incubationtime_max</span> <span class="op">&lt;-</span> <span class="va">covid_incubationtime</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">quantile</span><span class="op">(</span>p <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">base</span><span class="fu">::</span><span class="fu">round</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># incubation period: adapt to {EpiNow2} distribution interface</span></span>
<span><span class="va">covid_incubationtime_epinow</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">LogNormal</span><span class="op">(</span></span>
<span>  meanlog <span class="op">=</span> <span class="va">covid_incubationtime_params</span><span class="op">[</span><span class="st">"meanlog"</span><span class="op">]</span>,</span>
<span>  sdlog <span class="op">=</span> <span class="va">covid_incubationtime_params</span><span class="op">[</span><span class="st">"sdlog"</span><span class="op">]</span>,</span>
<span>  max <span class="op">=</span> <span class="va">covid_incubationtime_max</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect required input</span></span>
<span><span class="va">covid_generationtime</span></span>
<span><span class="va">covid_reportdelay</span></span>
<span><span class="va">covid_incubationtime_epinow</span></span>
<span></span>
<span></span>
<span><span class="co"># Set the number of parallel cores for {EpiNow2} --------------------------</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu">local_options</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu">detectCores</span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Estimate transmission using EpiNow2::epinow() ---------------------------</span></span>
<span><span class="co"># with EpiNow2::*_opts() functions for generation time, delays, and stan.</span></span>
<span><span class="va">covid_estimates</span> <span class="op">&lt;-</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">epinow</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat_covid</span>,</span>
<span>  generation_time <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">generation_time_opts</span><span class="op">(</span><span class="va">covid_generationtime</span><span class="op">)</span>,</span>
<span>  delays <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">delay_opts</span><span class="op">(</span><span class="va">covid_reportdelay</span> <span class="op">+</span> <span class="va">covid_incubationtime_epinow</span><span class="op">)</span>,</span>
<span>  stan <span class="op">=</span> <span class="fu">EpiNow2</span><span class="fu">::</span><span class="fu">stan_opts</span><span class="op">(</span>samples <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Print plot and summary table outputs ------------------------------------</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">covid_estimates</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_estimates</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a></h4>
<div class="section level5">
<h5 id="group-1-covid-30-days">Group 1: COVID 30 days<a class="anchor" aria-label="anchor" href="#group-1-covid-30-days"></a></h5>
<p>With reporting delay plus Incubation time:
<img src="https://hackmd.io/_uploads/BJl8wYiDC.png" style="width:25.0%" alt="image" class="figure"></p>
<p>With reporting delay plus Incubation time:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="op">&gt;</span> summary<span class="kw">(</span><span class="ex">covid30_epinow_delay</span><span class="kw">)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                            <span class="ex">measure</span>               estimate</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                             <span class="op">&lt;</span>char<span class="op">&gt;</span>                 <span class="op">&lt;</span>char<span class="op">&gt;</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">1:</span>           New infections per day  13193 <span class="er">(</span><span class="ex">5129</span> <span class="at">--</span> 33668<span class="kw">)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">2:</span> Expected change in daily reports      Likely increasing</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">3:</span>       Effective reproduction no.      1.5 <span class="er">(</span><span class="ex">0.92</span> <span class="at">--</span> 2.5<span class="kw">)</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="ex">4:</span>                   Rate of growth 0.099 <span class="er">(</span><span class="ex">-0.049</span> <span class="at">--</span> 0.26<span class="kw">)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="ex">5:</span>     Doubling/halving time <span class="er">(</span><span class="ex">days</span><span class="kw">)</span>         <span class="ex">7</span> <span class="er">(</span><span class="ex">2.7</span> <span class="at">--</span> <span class="at">-14</span><span class="kw">)</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="group-2-ebola-35-days">Group 2: Ebola 35 days<a class="anchor" aria-label="anchor" href="#group-2-ebola-35-days"></a></h5>
<p>With reporting delay plus Incubation time:
<img src="https://hackmd.io/_uploads/H1ZrYYsvR.png" style="width:25.0%" alt="image" class="figure"></p>
<p>With reporting delay plus Incubation time:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="op">&gt;</span> summary<span class="kw">(</span><span class="ex">ebola35_epinow_delays</span><span class="kw">)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                            <span class="ex">measure</span>               estimate</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                             <span class="op">&lt;</span>char<span class="op">&gt;</span>                 <span class="op">&lt;</span>char<span class="op">&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">1:</span>           New infections per day            5 <span class="er">(</span><span class="ex">0</span> <span class="at">--</span> 26<span class="kw">)</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="ex">2:</span> Expected change in daily reports      Likely decreasing</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">3:</span>       Effective reproduction no.     0.66 <span class="er">(</span><span class="ex">0.13</span> <span class="at">--</span> 2.2<span class="kw">)</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">4:</span>                   Rate of growth <span class="at">-0.039</span> <span class="er">(</span><span class="ex">-0.18</span> <span class="at">--</span> 0.12<span class="kw">)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="ex">5:</span>     Doubling/halving time <span class="er">(</span><span class="ex">days</span><span class="kw">)</span>      <span class="ex">-18</span> <span class="er">(</span><span class="ex">5.5</span> <span class="at">--</span> <span class="at">-3.9</span><span class="kw">)</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="group-3-ebola-60-days">Group 3: Ebola 60 days<a class="anchor" aria-label="anchor" href="#group-3-ebola-60-days"></a></h5>
<p>With reporting delay plus Incubation time:
<img src="https://hackmd.io/_uploads/Byu3FFoDR.png" style="width:25.0%" alt="image" class="figure"></p>
<p>With reporting delay plus Incubation time:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="op">&gt;</span> summary<span class="kw">(</span><span class="ex">ebola60_epinow_delays</span><span class="kw">)</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                            <span class="ex">measure</span>                  estimate</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                             <span class="op">&lt;</span>char<span class="op">&gt;</span>                    <span class="op">&lt;</span>char<span class="op">&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="ex">1:</span>           New infections per day                0 <span class="er">(</span><span class="ex">0</span> <span class="at">--</span> 0<span class="kw">)</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">2:</span> Expected change in daily reports                Decreasing</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="ex">3:</span>       Effective reproduction no.    0.038 <span class="er">(</span><span class="ex">0.0013</span> <span class="at">--</span> 0.39<span class="kw">)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">4:</span>                   Rate of growth <span class="at">-0.16</span> <span class="er">(</span><span class="ex">-0.32</span> <span class="at">--</span> <span class="at">-0.00055</span><span class="kw">)</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">5:</span>     Doubling/halving time <span class="er">(</span><span class="ex">days</span><span class="kw">)</span>      <span class="ex">-4.4</span> <span class="er">(</span><span class="ex">-1300</span> <span class="at">--</span> <span class="at">-2.2</span><span class="kw">)</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="group-4-covid-60-days">Group 4: COVID 60 days<a class="anchor" aria-label="anchor" href="#group-4-covid-60-days"></a></h5>
<p>With reporting delay plus Incubation time:
<img src="https://hackmd.io/_uploads/S1q6ItjvC.png" style="width:25.0%" alt="image" class="figure"></p>
<p>With reporting delay plus Incubation time:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="op">&gt;</span> summary<span class="kw">(</span><span class="ex">covid60_epinow_delays</span><span class="kw">)</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                            <span class="ex">measure</span>               estimate</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                             <span class="op">&lt;</span>char<span class="op">&gt;</span>                 <span class="op">&lt;</span>char<span class="op">&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="ex">1:</span>           New infections per day     1987 <span class="er">(</span><span class="ex">760</span> <span class="at">--</span> 4566<span class="kw">)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="ex">2:</span> Expected change in daily reports      Likely decreasing</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="ex">3:</span>       Effective reproduction no.     0.81 <span class="er">(</span><span class="ex">0.43</span> <span class="at">--</span> 1.3<span class="kw">)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="ex">4:</span>                   Rate of growth <span class="at">-0.047</span> <span class="er">(</span><span class="ex">-0.2</span> <span class="at">--</span> 0.092<span class="kw">)</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="ex">5:</span>     Doubling/halving time <span class="er">(</span><span class="ex">days</span><span class="kw">)</span>      <span class="ex">-15</span> <span class="er">(</span><span class="ex">7.5</span> <span class="at">--</span> <span class="at">-3.5</span><span class="kw">)</span></span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a></h4>
<p>Interpretation template:</p>
<ul><li><p>From the summary of our analysis we see that the expected change
in reports is <code>Likely decreasing</code> with the estimated new
infections, on average, of <code>1987</code> with 90% credible interval
of <code>760</code> to <code>4566</code>.</p></li>
<li><p>The effective reproduction number <span class="math inline">\(R_t\)</span> estimate (on the last date of the
data), or the number of new infections caused by one infectious
individual, on average, is <code>0.81</code>, with a 90% credible
interval of <code>0.43</code> to <code>1.30</code>.</p></li>
<li><p>The exponential growth rate of case reports is, on average
<code>-0.047</code>, with a 90% credible interval of <code>-0.2</code>
to <code>0.01</code>.</p></li>
<li><p>The doubling time (the time taken for case reports to double) is,
on average, <code>-15.0</code>, with a 90% credible interval of
<code>7.5</code> to <code>-3.5</code>.</p></li>
</ul><p>Interpretation Helpers:</p>
<ul><li>About the effective reproduction number:
<ul><li>An Rt greater than 1 implies an increase in cases or an
epidemic.</li>
<li>An Rt less than 1 implies a decrease in transmission, which could
lead to extinction if sustained.</li>
</ul></li>
<li>An analysis closest to extinction has a central estimate of:
<ul><li>Rt less than 1</li>
<li>growth rate is negative</li>
<li>doubling or halving time negative, which indicate a decline in
cases</li>
</ul></li>
<li>However, given the uncertainty in all of these estimates, there is
no statistical evidence of extinction if the 90% credible intervals of:
<ul><li>Rt include the value 1,</li>
<li>growth rate include the value 0,</li>
<li>doubling or halving time include the value 0.</li>
</ul></li>
<li>From table:
<ul><li>The values from the <code>summary()</code> output correspond to the
latest available date under analysis.</li>
<li>The <code>Expected change in reports</code> categories (e.g.,
<code>Stable</code> or <code>Likely decreasing</code>) describe the
expected change in daily cases based on the posterior probability that
Rt &lt; 1. Find the tutorial table at: <a href="https://epiverse-trace.github.io/tutorials-middle/quantify-transmissibility.html#expected-change-in-reports" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/quantify-transmissibility.html#expected-change-in-reports</a>
</li>
</ul></li>
<li>From figure:
<ul><li>The estimate of Reports fits the input incidence curve.</li>
<li>The forecast of New infections and Reports per day assumes no change
in the reproduction number. For that reason, the forecast section of
“Effective reproduction no.” is constant.</li>
<li>When we include at <code>delays</code> both the incubation and
reporting delay,
<ul><li>In Reports, the forecast credible intervals increases.</li>
<li>New infections per day, uncertainty increases in an equivalent size
to the delays</li>
</ul></li>
</ul></li>
<li>From comparing COVID and Ebola outputs:
<ul><li>The finite maximum value of the generation time distribution define
the range of the “estimate based on parial data”.</li>
</ul></li>
</ul></div>
</div>
</div>
<div class="section level2">
<h2 id="activity-2-severity">Activity 2: Severity<a class="anchor" aria-label="anchor" href="#activity-2-severity"></a></h2>
<p>Estimate the <em>naive CFR (nCFR)</em> and <em>delay-adjusted CFR
(aCFR)</em> using the following inputs:</p>
<ul><li>Reported cases (aggregate incidence by date of onset)</li>
<li>Onset to death delay</li>
</ul><p>As a group, Write your answers to these questions:</p>
<ul><li>What phase of the epidemic are you observing? (Exponential growth
phase, near peak, or decay end phase)</li>
<li>Does the time series include all the possible deaths to observe from
known cases?</li>
<li>How much difference is there between the nCFR and aCFR
estimates?</li>
<li>Interpret: How would you communicate these results to a
decision-maker?</li>
<li>Compare: What differences do you identify from other group outputs?
(if available)</li>
</ul><div class="section level3">
<h3 id="inputs-1">Inputs<a class="anchor" aria-label="anchor" href="#inputs-1"></a></h3>
<table class="table"><colgroup><col width="4%"><col width="18%"><col width="24%"><col width="52%"></colgroup><thead><tr class="header"><th>Group</th>
<th>Data</th>
<th>Action to data input</th>
<th>Link</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td>COVID-19 Diamond Princess</td>
<td>Keep dates before March 1st</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/diamond_70days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/diamond_70days.rds</a></td>
</tr><tr class="even"><td>2</td>
<td>COVID-19 Diamond Princess</td>
<td>Estimate from complete time series</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/diamond_70days.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/diamond_70days.rds</a></td>
</tr><tr class="odd"><td>3</td>
<td>MERS Korea 2015</td>
<td>Adapt from incidence to {cfr}</td>
<td><a href="https://epiverse-trace.github.io/tutorials-middle/data/mers_linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/mers_linelist.rds</a></td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="solution-1">Solution<a class="anchor" aria-label="anchor" href="#solution-1"></a></h3>
<!-- visible for instructors and learners after practical (solutions) -->
<div class="section level4">
<h4 id="code-1">Code<a class="anchor" aria-label="anchor" href="#code-1"></a></h4>
<div class="section level5">
<h5 id="covid-sample-1">COVID (sample)<a class="anchor" aria-label="anchor" href="#covid-sample-1"></a></h5>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Read reported cases -----------------------------------------------------</span></span>
<span><span class="va">covid_dat</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/diamond_70days.rds"</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">covid_dat</span></span>
<span></span>
<span></span>
<span><span class="co"># Create incidence object ------------------------------------------------</span></span>
<span><span class="va">covid_incidence</span> <span class="op">&lt;-</span> <span class="va">covid_dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>    counts <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cases"</span>, <span class="st">"deaths"</span><span class="op">)</span>,</span>
<span>    complete_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">covid_incidence</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Confirm {cfr} data input format ----------------------------------------</span></span>
<span></span>
<span><span class="co"># does input data already adapted to {cfr} input? Yes.</span></span>
<span><span class="va">covid_adapted</span> <span class="op">&lt;-</span> <span class="va">covid_dat</span></span>
<span><span class="co"># does input data require to be adapted to {cfr}? No.</span></span>
<span><span class="co"># covid_adapted &lt;- covid_incidence %&gt;%</span></span>
<span><span class="co">#   cfr::prepare_data(</span></span>
<span><span class="co">#     cases = "cases",</span></span>
<span><span class="co">#     deaths = "deaths"</span></span>
<span><span class="co">#   )</span></span>
<span></span>
<span><span class="va">covid_adapted</span></span>
<span></span>
<span><span class="co"># Access delay distribution -----------------------------------------------</span></span>
<span><span class="va">covid_delay</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"covid"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"onset-to-death"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Estimate naive and adjusted CFR ----------------------------------------</span></span>
<span></span>
<span><span class="co"># Estimate Static Delay-Adjusted CFR</span></span>
<span><span class="va">covid_dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span></span>
<span>    <span class="va">date</span> <span class="op">&lt;</span> <span class="fu">ymd</span><span class="op">(</span><span class="fl">20200301</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate Static Delay-Adjusted CFR</span></span>
<span><span class="va">covid_dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span></span>
<span>    <span class="va">date</span> <span class="op">&lt;</span> <span class="fu">ymd</span><span class="op">(</span><span class="fl">20200301</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span></span>
<span>    delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">density</span><span class="op">(</span><span class="va">covid_delay</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># CFR estimates in whole data --------------------------------------------</span></span>
<span></span>
<span><span class="co"># Estimate Static Delay-Adjusted CFR</span></span>
<span><span class="va">covid_dat</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate Static Delay-Adjusted CFR</span></span>
<span><span class="va">covid_dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span></span>
<span>    delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">density</span><span class="op">(</span><span class="va">covid_delay</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level5">
<h5 id="mers-sample">MERS (sample)<a class="anchor" aria-label="anchor" href="#mers-sample"></a></h5>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">cfr</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Read reported cases -----------------------------------------------------</span></span>
<span><span class="va">mers_dat</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/mers_linelist.rds"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mers_dat</span></span>
<span></span>
<span></span>
<span><span class="co"># Create incidence object ------------------------------------------------</span></span>
<span><span class="va">mers_incidence</span> <span class="op">&lt;-</span> <span class="va">mers_dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">incidence2</span><span class="fu">::</span><span class="fu">incidence</span><span class="op">(</span></span>
<span>    date_index <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"dt_onset"</span>, <span class="st">"dt_death"</span><span class="op">)</span>,</span>
<span>    complete_dates <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">mers_incidence</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Confirm {cfr} data input format ----------------------------------------</span></span>
<span></span>
<span><span class="co"># does input data already adapted to {cfr} input? No.</span></span>
<span><span class="co"># mers_adapted &lt;- mers_dat</span></span>
<span><span class="co"># does input data require to be adapted to {cfr}? Yes.</span></span>
<span><span class="va">mers_adapted</span> <span class="op">&lt;-</span> <span class="va">mers_incidence</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">prepare_data</span><span class="op">(</span></span>
<span>    cases <span class="op">=</span> <span class="st">"dt_onset"</span>,</span>
<span>    deaths <span class="op">=</span> <span class="st">"dt_death"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">mers_adapted</span></span>
<span></span>
<span><span class="co"># Access delay distribution -----------------------------------------------</span></span>
<span><span class="va">mers_delay</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter_db</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"mers"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"onset-to-death"</span>,</span>
<span>  single_epiparameter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Estimate naive and adjusted CFR ----------------------------------------</span></span>
<span></span>
<span><span class="co"># Estimate Static CFR</span></span>
<span><span class="va">mers_adapted</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># filter(</span></span>
<span>  <span class="co">#   #&lt;COMPLETE&gt;</span></span>
<span>  <span class="co"># ) %&gt;%</span></span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate Static Delay-Adjusted CFR</span></span>
<span><span class="va">mers_adapted</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># filter(</span></span>
<span>  <span class="co">#   #&lt;COMPLETE&gt;</span></span>
<span>  <span class="co"># ) %&gt;%</span></span>
<span>  <span class="fu">cfr</span><span class="fu">::</span><span class="fu">cfr_static</span><span class="op">(</span></span>
<span>    delay_density <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">density</span><span class="op">(</span><span class="va">mers_delay</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="outputs-1">Outputs<a class="anchor" aria-label="anchor" href="#outputs-1"></a></h4>
<table class="table"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr class="header"><th>Covid Diamond Princess 2020</th>
<th>Mers Korea 2015</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/ryWr0vNRyx.png" alt="image" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/Sk2J0kjA1g.png" alt="image" class="figure"></td>
</tr></tbody></table><table class="table"><colgroup><col width="16%"><col width="50%"><col width="13%"><col width="9%"><col width="9%"></colgroup><thead><tr class="header"><th>Data Input</th>
<th>Filter Category</th>
<th>estimate</th>
<th>low</th>
<th>high</th>
</tr></thead><tbody><tr class="odd"><td>covid</td>
<td>date &lt; 2020-03-01</td>
<td>0.009</td>
<td>0.003</td>
<td>0.018</td>
</tr><tr class="even"><td>covid</td>
<td>date &lt; 2020-03-01 + delay density</td>
<td>0.026</td>
<td>0.010</td>
<td>0.053</td>
</tr><tr class="odd"><td>covid</td>
<td>no filter</td>
<td>0.020</td>
<td>0.011</td>
<td>0.033</td>
</tr><tr class="even"><td>covid</td>
<td>delay density</td>
<td>0.020</td>
<td>0.011</td>
<td>0.033</td>
</tr><tr class="odd"><td>mers</td>
<td>no filter</td>
<td>0.074</td>
<td>0.036</td>
<td>0.132</td>
</tr><tr class="even"><td>mers</td>
<td>delay density</td>
<td>0.138</td>
<td>0.072</td>
<td>0.229</td>
</tr></tbody></table></div>
<div class="section level4">
<h4 id="interpretation-1">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation-1"></a></h4>
<p>Interpretation template:</p>
<ul><li>As of <code>15th June 2015</code>, the MERS cases in the population
have a delay-adjusted case fatality risk of <code>13.8%</code> with a
95% confidence interval between <code>7.2%</code> and
<code>22.9%</code>.</li>
</ul><p>Intepretation helpers:</p>
<ul><li>The MERS incidence curve seems to be in a decay phase. However, it
is expected to have death reports in upcoming dates, as observed in the
COVID Diamond Princess data.</li>
<li>For COVID, until the end of February (on March 1st), the aCFR
central estimate is closer to the CFR estimates on April 15th.</li>
<li>For MERS, the aCFR estimate is almost the double of the nCFR
estimate.</li>
</ul><p>Complementary notes:</p>
<ul><li>
<code>cfr::static()</code> assumption and limitations
<ul><li>One key assumption of <code>cfr::static()</code> is that reporting
rate and fatality risk is consistent over the time window
considered.</li>
<li>Early data from national surveillance systems had limitations (e.g.,
limited testing, changing case definitions, often only most severe being
tested -a.k.a., preferential assessertainment-). So neither method (aCFR
nor nCFR) gives the ‘true’ % of fatal symptomatic cases.</li>
<li>Compared to the Diamond Princess data, for national surveillance
systems <code>cfr::static()</code> is therefore most useful over longer
timeseries.</li>
<li>Alternativelly, <a href="https://github.com/epiverse-trace/cfr" class="external-link">cfr</a> can also estimate the proportion
of cases that are ascertained during an outbreak using
<code>cfr::estimate_ascertainment()</code>.</li>
</ul></li>
</ul></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="continue-your-learning-path">Continue your learning path<a class="anchor" aria-label="anchor" href="#continue-your-learning-path"></a></h1>
<!-- Suggest learners to Epiverse-TRACE documentation or external resources --->
<p>{EpiNow2} Case studies and use in the literature</p>
<ul><li><a href="https://epiforecasts.io/EpiNow2/articles/case-studies.html" class="external-link uri">https://epiforecasts.io/EpiNow2/articles/case-studies.html</a></li>
</ul><p>{cfr} Estimating the proportion of cases that are ascertained during
an outbreak</p>
<ul><li><a href="https://epiverse-trace.github.io/cfr/articles/estimate_ascertainment.html" class="external-link uri">https://epiverse-trace.github.io/cfr/articles/estimate_ascertainment.html</a></li>
</ul></div>
<div class="section level1">
<h1 id="end">end<a class="anchor" aria-label="anchor" href="#end"></a></h1>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials/edit/main/instructors/02-practical-tutors.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials/02-practical-tutors.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "forecasts, epidemic models, interventions",
  "name": "",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials/02-practical-tutors.html",
  "identifier": "https://epiverse-trace.github.io/tutorials/02-practical-tutors.html",
  "dateCreated": "2025-05-29",
  "dateModified": "2025-05-29",
  "datePublished": "2025-05-29"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

