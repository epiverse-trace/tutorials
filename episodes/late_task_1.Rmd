---
title: 'Simulating transmission scenarios'
teaching: 10 # teaching time in minutes
exercises: 5 # exercise time in minutes
---

:::::::::::::::::::::::::::::::::::::: questions 

- What model structure do I need?
- How do I read in a social contact matrix? 
- How do I run a model simulation?

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: objectives

Using the R package `epidemics`, learn how to: 

- load an existing model structure,
- load an existing social contact matrix,
- run a model simulation using.

::::::::::::::::::::::::::::::::::::::::::::::::

## Introduction

Introductory text

:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::: instructor

Inline instructor notes can help inform instructors of timing challenges
associated with the lessons. They appear in the "Instructor View"

::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: prereq

## Prerequisties

List (and hyperlink) the lessons/packages which need to be covered before this lesson

:::::::::::::::::::::::::::::::::

## Model structures

### Model types

*Outbreak* definition

*Epidemic* definition

<!-- Check model library -->

::::::::::::::::::::::::::::::::::::: callout
## Check model equations
When using existing model structures always check the model assumptions. Ask questions such as:

- How is transmission modelled? 
- What parameters are included?
- How many state variables are there?

There can be subtle differences in model structures for the same infection/outbreak type which can be missed without studying the equations.
::::::::::::::::::::::::::::::::::::::::::::::::


### An epidemic model

<!-- Default epidemic model -->

$C_i,j$ rows $i$ and columns $j$

$$
\begin{aligned}
\frac{dS_i}{dt} & = - \beta S_i \sum_j C_{i,j} I_j -\nu_t S_i \\
\frac{dE_i}{dt} &= \beta S_i\sum_j C_{i,j} I_j - \alpha E_i \\
\frac{dI_i}{dt} &= \alpha E_i - \gamma I_i \\
\frac{dR_i}{dt} &=\gamma I_i \\
\frac{dV_i}{dt} &=\nu_t S_i\\
\end{aligned}
$$

::::::::::::::::::::::::::::::::::::: challenge 

## Challenge 1 : can the learner run existing code

Load contact and population data from socialmixr::polymod

```r
polymod <- socialmixr::polymod
contact_data <- socialmixr::contact_matrix(
  polymod,
  countries = "United Kingdom",
  age.limits = c(0, 20, 40),
  symmetric = TRUE
)
contact_data
```

:::::::::::::::::::::::: solution 

## Output
 
```{r polymod_uk, echo = FALSE}
 polymod <- socialmixr::polymod
contact_data <- socialmixr::contact_matrix(
  polymod,
  countries = "United Kingdom",
  age.limits = c(0, 20, 40),
  symmetric = TRUE
)
contact_data
```


:::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::::::::::::::::::::::::


## Contact matrix and demography

Lesson content

::::::::::::::::::::::::::::::::::::: callout
## Explainer
Add additional maths (or epi) content for novice learners

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: challenge 

## Challenge 2 : edit code/answer a question

Load contact and population data for Poland from socialmixr::polymod using the following age bins:

+ [0,15)
+ [15, 50)
+ 50 +

:::::::::::::::::::::::: solution 

```{r polymod_poland}
polymod <- socialmixr::polymod
contact_data <- socialmixr::contact_matrix(
  polymod,
  countries = "Poland",
  age.limits = c(0, 15, 50),
  symmetric = TRUE
)
contact_data
```
:::::::::::::::::::::::::::::::::
::::::::::::::::::::::::::::::::::::::::::::::::

## Model parameters

Lesson content

## Running simulations

Lesson content


::::::::::::::::::::::::::::::::::::: keypoints 

- Summarise the key points of the lesson using bullet points


::::::::::::::::::::::::::::::::::::::::::::::::
