---
title: 'Outbreak analytics pipelines'
teaching: 10
exercises: 2
editor_options: 
  chunk_output_type: console
---

:::::::::::::::::::::::::::::::::::::: questions 

- Why to use R packages for Outbreak analytics?
- What can we do to analyse our outbreak data?
- How can I start doing Outbreak analytics with R?

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: objectives

- Explain our vision on the need of outbreak analytics R packages. 
- Share our strategy to create R packages into an outbreak analytics pipeline.
- Define our plan to start your learning path in outbreak analytics with R.

::::::::::::::::::::::::::::::::::::::::::::::::

::::::::::::::::::::::::::::::::::::: prereq

## Prerequisites

This episode requires you to be familiar with:

**Data science** : Basic programming with R.

**Epidemic theory** : Reproduction number.

This also requires the following package:

```r
install_version(
  package = "EpiNow2", version = "1.4.0", 
  repos = "http://cran.us.r-project.org"
)
```

:::::::::::::::::::::::::::::::::


## Introduction

_write about the Reproduction number (in a motivational way)_

Packages are handy tools to reuse code, maintenance, less error prone data analysis steps.

## Quantify transmission

The `{EpiNow2}` provide us with a a three-steps solution for this task!

```{r,warning=FALSE}
library(EpiNow2)
```


### First, get your data

A data frame of observation

```{r}
example_confirmed
```

### Then, set the parameters

The natural history of a disease influence the transmission

delay distributions

```{r}
incubation_period <- dist_spec(
  mean = 4, sd = 2,
  max = 20, distribution = "gamma"
)

reporting_delay <- dist_spec(
  mean = convert_to_logmean(2, 1), 
  sd = convert_to_logsd(2, 1),
  max = 10, distribution = "lognormal"
)

generation_time <- dist_spec(
  mean = 3.6, sd = 3.1,
  max = 20, distribution = "lognormal"
)
```

### Let's calculate the reproductive number!

```{r,message=FALSE,warning=FALSE,cache=TRUE}
epinow_estimates <- epinow(
  # cases
  reported_cases = example_confirmed[1:60],
  # delays
  generation_time = generation_time_opts(generation_time),
  delays = delay_opts(
    incubation_period + reporting_delay
  ),
  # computation
  stan = stan_opts(
    cores = 4, samples = 1000, chains = 2,
    control = list(adapt_delta = 0.99)
  )
)
```

```{r}
base::plot(epinow_estimates)
```

## The problem!

However, doing this in real life is not as easy as this example!

Usually, we receive outbreak data in non-standard formats that require specific steps for make them useful data inputs. Some of them are:

- Read parameters from literature
- Read and clean case data
- Validate your linelist
- Describe case data

After this, we can use the reproductive number and other outputs as inputs for other outbreak analytics tasks. For example:

- Forecast cases
- Estimate severity
- Simulate transmission scenarios
- Compare interventions

So, all these tasks can be interconnected in a pipeline:

![The outbreak analytics pipeline.](https://epiverse-trace.github.io/task_pipeline-minimal.svg)

::::::::::::::::::::::::::::::::: discussion

### Questions to think about

Remember your last experience with outbreak data and reflect in these questions:

- What data sources you needed to understand the outbreak?
- How did you get accessed to that data?
- Is that analysis pipeline you followed reusable for a next response?

Pair up and share your experiences.

:::::::::::::::::::::::::::::::::::::::::::

## What can we do?

One strategy is to incorporate specialized R packages into your traditional analysis pipeline. These packages should fill the gaps of these epidemiology specific challenges in response to outbreaks. 

Epiverse-TRACE aim is to provide a software ecosystem for outbreak analytics. This includes to support the development of software pieces, make the existing ones interoperable for the user experience, and stimulate a community of practice.

![](fig/pkgs-hexlogos.png)

## How can I start?

Our plan for these tutorials is to introduce key solutions from packages in the outbreak analytics pipeline, plus the required theory concepts to interpret modelling outputs and make rigorous conclusions.

- In the first set of episodes, you will learn how to optimize the reading and cleaning of epidemiological parameters and case data to input them into the _Quantify transmission_ pipeline. These preliminary tasks are the __Early tasks__. Packages here are `{readepi}`, `{cleanepi}`, `{linelist}`, `{epiparameter}`, and `{episoap}`.

- Then, we are going to get deeper into the packages and required theory to _Quantify transmission_ and perform more real-time analysis task next to it. These are the __Middle tasks__. Packages here are `{EpiNow2}`, `{cfr}`, `{epichains}`, and `{superspreading}`.

- Lastly, we will use _Quantify transmission_ data outputs to compare it to other indicators and simulate epidemic scenarios as part of the __Late tasks__. Packages here are `{finalsize}`, `{epidemics}`, `{scenarios}`, and `{vaccineff}`.


::::::::::::::::::::::::::::::::::::: keypoints 

- Our vision is to have pipelines of R packages for outbreak analytics.
- Our strategy is to create interconnected tasks to get public health relevant outputs.
- Our plan is to introduce about package solutions and theory bits for each of the tasks in the outbreak analytics pipeline.

::::::::::::::::::::::::::::::::::::::::::::::::

