<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Outbreak analytics with R: </title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XZ471458FQ');
    </script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/epiverse-trace/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicons/epiverse-trace/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicons/epiverse-trace/favicon-16x16.png"><link rel="manifest" href="favicons/epiverse-trace/site.webmanifest"><link rel="mask-icon" href="favicons/epiverse-trace/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav epiverse-trace"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="epiverse-trace-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo.svg"><span class="badge text-bg-danger" style="background-color: #FF4955; border-radius: 5px">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/03-practical-tutors.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav epiverse-trace" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="epiverse-trace" src="assets/images/epiverse-trace-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Outbreak analytics with R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Outbreak analytics with R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Outbreak analytics with R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NA%" class="percentage">
    NA%
  </div>
  <div class="progress epiverse-trace">
    <div class="progress-bar epiverse-trace" role="progressbar" style="width: NA%" aria-valuenow="NA" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/03-practical-tutors.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="delays-introduction.html">1. Introduction to outbreak analytics</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="delays-distribution.html">2. Introduction to delays</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Glossary of Terms: Epiverse-TRACE</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1></h1>
        <p>Last updated on 2025-05-20 |

        <a href="https://github.com/epiverse-trace/tutorials/edit/main/instructors/03-practical-tutors.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="section level1">
<h1 id="week-3-estimate-superspreading-and-simulate-transmission-chains">Week 3: Estimate superspreading and simulate transmission
chains<a class="anchor" aria-label="anchor" href="#week-3-estimate-superspreading-and-simulate-transmission-chains"></a></h1>
<!-- visible for instructors only -->
<!-- practical-week.md is generated from practical-week.qmd. Please edit that file -->
<!-- commit .md and .qmd files together -->
<!-- does not work for instructors text messages -->
<!-- works for text on html and MD only -->
<p>This practical is based in the following tutorial episodes:</p>
<ul><li><a href="https://epiverse-trace.github.io/tutorials-middle/superspreading-estimate.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/superspreading-estimate.html</a></li>
<li><a href="https://epiverse-trace.github.io/tutorials-middle/superspreading-simulate.html" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/superspreading-simulate.html</a></li>
</ul><p>Welcome!</p>
<ul><li>A reminder of our <a href="https://github.com/epiverse-trace/.github/blob/main/CODE_OF_CONDUCT.md" class="external-link">Code
of Conduct</a>. If you experience or witness unacceptable behaviour, or
have any other concerns, please notify the course organisers or host of
the event. To report an issue involving one of the organisers, please
use the <a href="https://reportandsupport.lshtm.ac.uk/" class="external-link">LSHTM’s Report
and Support tool</a>.</li>
</ul></div>
<div class="section level1">
<h1 id="read-this-first">Read This First<a class="anchor" aria-label="anchor" href="#read-this-first"></a></h1>
<!-- visible for learners and instructors at practical -->
<p>Instructions:</p>
<ul><li>Each <code>Activity</code> has five sections: the Goal, Questions,
Inputs, Your Code, and Your Answers.</li>
<li>Solve each Activity in the corresponding <code>.R</code> file
mentioned in the <code>Your Code</code> section.</li>
<li>Paste your figure and table outputs and write your answer to the
questions in the section <code>Your Answers</code>.</li>
<li>Choose one group member to share your group’s results with the rest
of the participants.</li>
</ul><p>During the practical, instead of simply copying and pasting, we
encourage learners to increase their fluency writing R by using:</p>
<ul><li>The double-colon notation, e.g. <code>package::function()</code> to
specify which package a function comes from, avoid namespace conflicts,
and find functions using keywords.</li>
<li>Tab key <kbd>↹</kbd> to <a href="https://support.posit.co/hc/en-us/articles/205273297-Code-Completion-in-the-RStudio-IDE" class="external-link">autocomplete
package or function names</a> and <a href="https://docs.posit.co/ide/user/ide/guide/code/console.html" class="external-link">display
possible arguments</a>.</li>
<li>
<a href="https://docs.posit.co/ide/user/ide/guide/code/execution.html" class="external-link">Execute
one line of code</a> or multiple lines connected by the pipe operator
(<code>%&gt;%</code>) by placing the cursor in the code of interest and
pressing the <code>Ctrl</code>+<code>Enter</code>.</li>
<li>
<a href="https://positron.posit.co/keyboard-shortcuts.html#r-shortcuts" class="external-link">R
shortcuts</a> to insert the pipe operator (<code>%&gt;%</code>) using
<code>Ctrl/Cmd</code>+<code>Shift</code>+<code>M</code>, or insert the
assignment operator (<code>&lt;-</code>) using
<code>Alt/Option</code>+<code>-</code>.
<!-- - Get [help yourself with R](https://www.r-project.org/help.html) using the `help()` function or `?` operator to access the function reference manual. -->
</li>
</ul><p>If your local configuration was not possible to setup:</p>
<ul><li>Create one copy of the <a href="https://posit.cloud/spaces/609790/join?access_code=hPM1tIeKt5ax_Y-P0lMGVUGqzFPNH4wxkKSzXZYb" class="external-link">Posit
Cloud RStudio project</a>.</li>
</ul><div class="section level2">
<h2 id="paste-your-error-messages-here">Paste your !Error messages here<a class="anchor" aria-label="anchor" href="#paste-your-error-messages-here"></a></h2>
</div>
</div>
<div class="section level1">
<h1 id="practical">Practical<a class="anchor" aria-label="anchor" href="#practical"></a></h1>
<p>This practical has two activities.</p>
<div class="section level2">
<h2 id="activity-1-account-for-superspreading">Activity 1: Account for superspreading<a class="anchor" aria-label="anchor" href="#activity-1-account-for-superspreading"></a></h2>
<p>Estimate extent of individual-level variation (i.e. the dispersion
parameter) of the offspring distribution, which refers to the
variability in the number of secondary cases per individual, and the
proportion of transmission that is linked to ‘superspreading events’
using the following available inputs:</p>
<ul><li>Line list of cases</li>
<li>Contact tracing data</li>
</ul><p>As a group, Write your answers to these questions:</p>
<ul><li>From descriptive and estimation steps:
<ul><li>What set has more infections related to fewer clusters in the
contact network?</li>
<li>What set has the most skewed histogram of secondary cases?</li>
<li>Does the estimated dispersion parameter correlate with the contact
network and histogram of secondary cases?</li>
</ul></li>
<li>On decision making:
<ul><li>What is the proportion of new cases originating from a cluster of at
least 10 cases?</li>
<li>Would you recommend a backward tracing strategy?</li>
</ul></li>
<li>Interpret: How would you communicate these results to a
decision-maker?</li>
<li>Compare: What differences do you identify from other group outputs?
(if available)</li>
</ul><div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a></h3>
<table class="table"><colgroup><col width="4%"><col width="95%"></colgroup><thead><tr class="header"><th>Group</th>
<th>Data</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-01-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-01-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-01-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-01-linelist.rds</a>
</td>
</tr><tr class="even"><td>2</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-02-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-02-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-02-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-02-linelist.rds</a>
</td>
</tr><tr class="odd"><td>3</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-03-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-03-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-03-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-03-linelist.rds</a>
</td>
</tr><tr class="even"><td>4</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-04-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-04-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-04-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-04-linelist.rds</a>
</td>
</tr><tr class="odd"><td>5</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-05-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-05-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-05-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-05-linelist.rds</a>
</td>
</tr><tr class="even"><td>6</td>
<td>
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-06-contacts.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-06-contacts.rds</a>,
<a href="https://epiverse-trace.github.io/tutorials-middle/data/set-06-linelist.rds" class="external-link uri">https://epiverse-trace.github.io/tutorials-middle/data/set-06-linelist.rds</a>
</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="solution">Solution<a class="anchor" aria-label="anchor" href="#solution"></a></h3>
<!-- visible for instructors and learners after practical (solutions) -->
<div class="section level4">
<h4 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a></h4>
<div class="section level5">
<h5 id="set-1-sample">Set 1 (sample)<a class="anchor" aria-label="anchor" href="#set-1-sample"></a></h5>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epicontacts</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">fitdistrplus</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Read linelist and contacts ----------------------------------------------</span></span>
<span><span class="va">dat_contacts</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/set-01-contacts.rds"</span>  <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_linelist</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_rds</span><span class="op">(</span></span>
<span>  <span class="st">"https://epiverse-trace.github.io/tutorials-middle/data/set-01-linelist.rds"</span>  <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Create an epicontacts object -------------------------------------------</span></span>
<span><span class="va">epi_contacts</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">epicontacts</span><span class="fu">::</span><span class="fu">make_epicontacts</span><span class="op">(</span></span>
<span>    linelist <span class="op">=</span> <span class="va">dat_linelist</span>,</span>
<span>    contacts <span class="op">=</span> <span class="va">dat_contacts</span>,</span>
<span>    directed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">epi_contacts</span></span>
<span></span>
<span><span class="co"># visualize the contact network</span></span>
<span><span class="va">contact_network</span> <span class="op">&lt;-</span> <span class="fu">epicontacts</span><span class="fu">::</span><span class="fu">vis_epicontacts</span><span class="op">(</span><span class="va">epi_contacts</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contact_network</span></span>
<span></span>
<span></span>
<span><span class="co"># Count secondary cases per subject in contacts and linelist --------</span></span>
<span><span class="va">secondary_cases</span> <span class="op">&lt;-</span> <span class="fu">epicontacts</span><span class="fu">::</span><span class="fu">get_degree</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">epi_contacts</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>  only_linelist <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the histogram of secondary cases</span></span>
<span><span class="va">individual_reproduction_num</span> <span class="op">&lt;-</span> <span class="va">secondary_cases</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">enframe</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Number of secondary cases"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">individual_reproduction_num</span></span>
<span></span>
<span></span>
<span><span class="co"># Fit a negative binomial distribution -----------------------------------</span></span>
<span><span class="va">offspring_fit</span> <span class="op">&lt;-</span> <span class="va">secondary_cases</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">fitdistrplus</span><span class="fu">::</span><span class="fu">fitdist</span><span class="op">(</span>distr <span class="op">=</span> <span class="st">"nbinom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">offspring_fit</span></span>
<span></span>
<span></span>
<span><span class="co"># Estimate proportion of new cases from a cluster of secondary cases -----</span></span>
<span></span>
<span><span class="co"># Set seed for random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate the proportion of new cases originating from </span></span>
<span><span class="co"># a transmission cluster of at least 5, 10, or 25 cases</span></span>
<span><span class="va">proportion_cases_by_cluster_size</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">superspreading</span><span class="fu">::</span><span class="fu">proportion_cluster_size</span><span class="op">(</span></span>
<span>    R <span class="op">=</span> <span class="va">offspring_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"mu"</span><span class="op">]</span>,</span>
<span>    k <span class="op">=</span> <span class="va">offspring_fit</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"size"</span><span class="op">]</span>,</span>
<span>    cluster_size <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">proportion_cases_by_cluster_size</span></span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a></h4>
<p>Group 1</p>
<table class="table"><colgroup><col width="50%"><col width="49%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>histogram of secondary cases</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/H1DVLbsTyx.png" alt="Untitled-1" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/BkW48Wo6yg.png" alt="Untitled" class="figure"></td>
</tr></tbody></table><p>Group 2</p>
<table class="table"><colgroup><col width="49%"><col width="50%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>histogram of secondary cases</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/Hkhg8WspJg.png" alt="Untitled" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/HyIlUWopJx.png" alt="Untitled-1" class="figure"></td>
</tr></tbody></table><p>Group 3</p>
<table class="table"><colgroup><col width="49%"><col width="50%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>histogram of secondary cases</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/HkzkUZjpyx.png" alt="Untitled" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/SkjCBZjpJe.png" alt="Untitled-1" class="figure"></td>
</tr></tbody></table><p>Group 1/2/3</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt;     R    k prop_5 prop_10 prop_25</span></span>
<span><span class="co">#&gt; 1 0.8 0.01  95.1%   89.8%   75.1%</span></span>
<span><span class="co">#&gt; 2 0.8 0.10  66.7%   38.7%    7.6%</span></span>
<span><span class="co">#&gt; 3 0.8 0.50  25.1%    2.8%      0%</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a></h4>
<p>Interpretation template:</p>
<ul><li>For R = 0.8 and k = 0.01:
<ul><li>The proportion of new cases originating from a cluster of at least 5
secondary cases from a primary case is 95%</li>
<li>The proportion of all transmission events that were part of
secondary case clusters (i.e., from the same primary case) of at least 5
cases is 95%</li>
</ul></li>
</ul><p>Interpretation Helpers:</p>
<ul><li>From the contact network, set 1 has the highest frequency of
infections related with a small proportion of clusters.</li>
<li>From the histogram of secondary cases, skewness in set 1 is higher
than set 2 and set 3.</li>
<li>Set 1 has cases with the highest number of secondary cases (n = 50),
compared with set 2 (n = ~25) and set 3 (n = 11).</li>
<li>The contact networks and histograms of secondary cases correlate
with the estimated dispersion parameters: A small proportion of clusters
generating most of new cases produces a more skewed histogram, and a
lowest estimate of dispersion parameter.</li>
<li>About probability of new cases from transmission cluster of size at
least 10 cases, and the recommending backward tracing strategy:
<ul><li>set 1: 89%, yes.</li>
<li>set 2: 38%, probably no?</li>
<li>set 3: 3%, no.</li>
</ul></li>
</ul></div>
</div>
</div>
<div class="section level2">
<h2 id="activity-2-simulate-transmission-chains">Activity 2: Simulate transmission chains<a class="anchor" aria-label="anchor" href="#activity-2-simulate-transmission-chains"></a></h2>
<p>Estimate the potential for large outbreaks that could occur based on
1000 simulated outbreaks using the following available inputs:</p>
<ul><li>Basic reproduction number</li>
<li>Dispersion parameter</li>
</ul><p>As a group, Write your answers to these questions:</p>
<ul><li>You have been assigned to explore <code>Chain ID</code>. From the
output data frame, describe:
<ul><li>How many generations there are.</li>
<li>Who infected whom, and when (with reference to the day of
infection).</li>
</ul></li>
<li>Among simulated outbreaks:
<ul><li>How many chains reached a 100 case threshold?</li>
<li>What is the maximum size of chain? (The cumulative number of
case)</li>
<li>What is the maximum length of chain? (The number of days until the
chain stops)</li>
</ul></li>
<li>Interpret: How would you communicate these results to a
decision-maker?</li>
<li>Compare: What differences do you identify from other group outputs?
(if available)</li>
</ul><div class="section level3">
<h3 id="inputs-1">Inputs<a class="anchor" aria-label="anchor" href="#inputs-1"></a></h3>
<table class="table"><thead><tr class="header"><th>Group</th>
<th>Parameters</th>
<th>Chain ID</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td>R = 0.8, k = 0.01</td>
<td>957</td>
</tr><tr class="even"><td>2</td>
<td>R = 0.8, k = 0.1</td>
<td>281</td>
</tr><tr class="odd"><td>3</td>
<td>R = 0.8, k = 0.5</td>
<td>38</td>
</tr><tr class="even"><td>4</td>
<td>R = 1.5, k = 0.01</td>
<td>261</td>
</tr><tr class="odd"><td>5</td>
<td>R = 1.5, k = 0.1</td>
<td>325</td>
</tr><tr class="even"><td>6</td>
<td>R = 1.5, k = 0.5</td>
<td>591</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="solution-1">Solution<a class="anchor" aria-label="anchor" href="#solution-1"></a></h3>
<!-- visible for instructors and learners after practical (solutions) -->
<div class="section level4">
<h4 id="code-1">Code<a class="anchor" aria-label="anchor" href="#code-1"></a></h4>
<div class="section level5">
<h5 id="set-1-sample-1">Set 1 (sample)<a class="anchor" aria-label="anchor" href="#set-1-sample-1"></a></h5>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages -----------------------------------------------------------</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epiparameter</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">epichains</span><span class="op">)</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Set input parameters ---------------------------------------------------</span></span>
<span><span class="va">known_basic_reproduction_number</span> <span class="op">&lt;-</span> <span class="fl">0.8</span> <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="va">known_dispersion</span> <span class="op">&lt;-</span> <span class="fl">0.01</span> <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span><span class="va">chain_to_observe</span> <span class="op">&lt;-</span> <span class="fl">957</span> <span class="co">#&lt;DIFFERENT PER GROUP&gt;</span></span>
<span></span>
<span></span>
<span><span class="co"># Set iteration parameters -----------------------------------------------</span></span>
<span></span>
<span><span class="co"># Create generation time as &lt;epiparameter&gt; object</span></span>
<span><span class="va">generation_time</span> <span class="op">&lt;-</span> <span class="fu">epiparameter</span><span class="fu">::</span><span class="fu">epiparameter</span><span class="op">(</span></span>
<span>  disease <span class="op">=</span> <span class="st">"disease x"</span>,</span>
<span>  epi_name <span class="op">=</span> <span class="st">"generation time"</span>,</span>
<span>  prob_distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  summary_stats <span class="op">=</span> <span class="fu">list</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Simulate multiple chains -----------------------------------------------</span></span>
<span><span class="co"># run set.seed() and epichains::simulate_chains() together, in the same run</span></span>
<span></span>
<span><span class="co"># Set seed for random number generator</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multiple_chains</span> <span class="op">&lt;-</span> <span class="fu">epichains</span><span class="fu">::</span><span class="fu">simulate_chains</span><span class="op">(</span></span>
<span>  <span class="co"># simulation controls</span></span>
<span>  n_chains <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># number of chains to simulate</span></span>
<span>  statistic <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>  stat_threshold <span class="op">=</span> <span class="fl">500</span>, <span class="co"># stopping criteria</span></span>
<span>  <span class="co"># offspring</span></span>
<span>  offspring_dist <span class="op">=</span> <span class="va">rnbinom</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">known_basic_reproduction_number</span>,</span>
<span>  size <span class="op">=</span> <span class="va">known_dispersion</span>,</span>
<span>  <span class="co"># generation</span></span>
<span>  generation_time <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">generate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">generation_time</span>, times <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">multiple_chains</span></span>
<span></span>
<span></span>
<span><span class="co"># Explore suggested chain ------------------------------------------------</span></span>
<span><span class="va">multiple_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># use data.frame output from &lt;epichains&gt; object</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">chain</span> <span class="op">==</span> <span class="va">chain_to_observe</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">print</span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># visualize ---------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># daily aggregate of cases</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">&lt;-</span> <span class="va">multiple_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># count the daily number of cases in each chain</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>day <span class="op">=</span> <span class="fu">ceiling</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">chain</span>, <span class="va">day</span>, name <span class="op">=</span> <span class="st">"cases"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># calculate the cumulative number of cases for each chain</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cumulative_cases <span class="op">=</span> <span class="fu">cumsum</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize transmission chains by cumulative cases</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># create grouped chain trajectories</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">cumulative_cases</span>, group <span class="op">=</span> <span class="va">chain</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># define a 100-case threshold</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Day"</span>, y <span class="op">=</span> <span class="st">"Cumulative cases"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># count chains over 100 cases</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">cumulative_cases</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">chain</span><span class="op">)</span></span>
<span><span class="co"># distribution of size of chains</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">cumulative_cases</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">skimr</span><span class="fu">::</span><span class="fu">skim</span><span class="op">(</span><span class="va">cumulative_cases</span><span class="op">)</span></span>
<span><span class="co"># distribution of lenght of chains</span></span>
<span><span class="va">aggregate_chains</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">cumulative_cases</span> <span class="op">&gt;=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">skimr</span><span class="fu">::</span><span class="fu">skim</span><span class="op">(</span><span class="va">day</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
<div class="section level4">
<h4 id="outputs-1">Outputs<a class="anchor" aria-label="anchor" href="#outputs-1"></a></h4>
<p>Group 1</p>
<table class="table"><colgroup><col width="34%"><col width="33%"><col width="31%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>secondary cases</th>
<th>simulated chains</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/H1DVLbsTyx.png" alt="Untitled-1" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/BkW48Wo6yg.png" alt="Untitled" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/Sy3x3MNAJe.png" alt="image" class="figure"></td>
</tr></tbody></table><p>Group 2</p>
<table class="table"><colgroup><col width="33%"><col width="34%"><col width="31%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>secondary cases</th>
<th>simulated chains</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/Hkhg8WspJg.png" alt="Untitled" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/HyIlUWopJx.png" alt="Untitled-1" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/rkw-hGN0kl.png" alt="image" class="figure"></td>
</tr></tbody></table><p>Group 3</p>
<table class="table"><colgroup><col width="33%"><col width="34%"><col width="31%"></colgroup><thead><tr class="header"><th>contact network</th>
<th>secondary cases</th>
<th>simulated chains</th>
</tr></thead><tbody><tr class="odd"><td><img src="https://hackmd.io/_uploads/HkzkUZjpyx.png" alt="Untitled" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/SkjCBZjpJe.png" alt="Untitled-1" class="figure"></td>
<td><img src="https://hackmd.io/_uploads/S1p-2MNRJe.png" alt="image" class="figure"></td>
</tr></tbody></table><p>Sample</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># infector-infectee data frame </span></span>
<span><span class="va">simulated_chains_map</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">simulation_id</span> <span class="op">==</span> <span class="fl">806</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">SH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode sh" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># A tibble: 9 × 6</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="ex">chain</span> infector infectee generation  time simulation_id</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="op">&lt;</span>int<span class="op">&gt;</span>    <span class="op">&lt;</span>dbl<span class="op">&gt;</span>    <span class="op">&lt;</span>dbl<span class="op">&gt;</span>      <span class="op">&lt;</span>int<span class="op">&gt;</span> <span class="op">&lt;</span>dbl<span class="op">&gt;</span>         <span class="op">&lt;</span>int<span class="op">&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="ex">1</span>     1       NA        1          1   0             806</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="ex">2</span>     1        1        2          2  16.4           806</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="ex">3</span>     1        1        3          2  11.8           806</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="ex">4</span>     1        1        4          2  10.8           806</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="ex">5</span>     1        1        5          2  11.4           806</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="ex">6</span>     1        1        6          2  10.2           806</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="ex">7</span>     1        2        7          3  26.0           806</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="ex">8</span>     1        2        8          3  29.8           806</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="ex">9</span>     1        2        9          3  26.6           806</span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="interpretation-1">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation-1"></a></h4>
<p>Interpretation template:</p>
<ul><li>Simulation <code>806</code> have <code>1</code> chain with
<code>3</code> known infectors (<code>NA</code>, 1, 2), and
<code>3</code> generations.</li>
<li>In the generation 0, subject <code>NA</code> infected subject
1.</li>
<li>In the generation 1, subject 1 infected subjects 2, 3, 4, 5, 6.
These infections occurred between day 10 and 16 after the “case
zero”.</li>
<li>In the generation 2, subject 2 infected subjects 7, 8, 9. These
infections occurred between day 26 and 29 after the “case zero”.</li>
</ul><p>Interpretation Helpers:</p>
<p>From the plot of cumulative cases by day for each simulated
chain:</p>
<table class="table"><colgroup><col width="7%"><col width="21%"><col width="31%"><col width="18%"><col width="20%"></colgroup><thead><tr class="header"><th>Group</th>
<th>Parameters</th>
<th>Number of Chains Above 100</th>
<th>Max Chain Size</th>
<th>Max Chain Length</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td>R = 0.8, k = 0.01</td>
<td>10</td>
<td>~200</td>
<td>~20 days</td>
</tr><tr class="even"><td>2</td>
<td>R = 0.8, k = 0.1</td>
<td>8</td>
<td>~420</td>
<td>~60 days</td>
</tr><tr class="odd"><td>3</td>
<td>R = 0.8, k = 0.5</td>
<td>3</td>
<td>~180</td>
<td>~70 days</td>
</tr><tr class="even"><td>4</td>
<td>R = 1.5, k = 0.01</td>
<td>16</td>
<td>~840</td>
<td>~20 days</td>
</tr><tr class="odd"><td>5</td>
<td>R = 1.5, k = 0.1</td>
<td>65</td>
<td>~890</td>
<td>~50 days</td>
</tr><tr class="even"><td>6</td>
<td>R = 1.5, k = 0.5</td>
<td>216</td>
<td>~850</td>
<td>~90 days</td>
</tr></tbody></table></div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="continue-your-learning-path">Continue your learning path<a class="anchor" aria-label="anchor" href="#continue-your-learning-path"></a></h1>
<!-- Suggest learners to Epiverse-TRACE documentation or external resources --->
<p>{superspreading} vignette on epidemic risk</p>
<ul><li><a href="https://epiverse-trace.github.io/superspreading/articles/epidemic_risk.html" class="external-link uri">https://epiverse-trace.github.io/superspreading/articles/epidemic_risk.html</a></li>
</ul><p>{epichains} vignette on projecting infectious disease incidence</p>
<ul><li><a href="https://epiverse-trace.github.io/epichains/articles/projecting_incidence.html" class="external-link uri">https://epiverse-trace.github.io/epichains/articles/projecting_incidence.html</a></li>
</ul><p>Epi R handbook episode on {epicontacts} to visualise transmission
chains in time</p>
<ul><li><a href="https://www.epirhandbook.com/en/transmission-chains.html" class="external-link uri">https://www.epirhandbook.com/en/transmission-chains.html</a></li>
</ul></div>
<div class="section level1">
<h1 id="end">end<a class="anchor" aria-label="anchor" href="#end"></a></h1>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>



      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="index.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Home
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/epiverse-trace/tutorials/edit/main/instructors/03-practical-tutors.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/epiverse-trace/tutorials/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/epiverse-trace/tutorials/" class="external-link">Source</a></p>
				<p><a href="https://github.com/epiverse-trace/tutorials/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:andree.valle-campos@lshtm.ac.uk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/epiverse-trace/sandpaper/tree/patch-renv-github-bug" class="external-link">sandpaper (0.16.11)</a>, <a href="https://github.com/carpentries/pegboard/tree/5e0d711121a581777d83cf270e298c933f112d52" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/epiverse-trace/varnish/tree/epiversetheme" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://epiverse-trace.github.io/tutorials/03-practical-tutors.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "forecasts, epidemic models, interventions",
  "name": "",
  "creativeWorkStatus": "active",
  "url": "https://epiverse-trace.github.io/tutorials/03-practical-tutors.html",
  "identifier": "https://epiverse-trace.github.io/tutorials/03-practical-tutors.html",
  "dateCreated": "2025-05-19",
  "dateModified": "2025-05-20",
  "datePublished": "2025-05-20"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

